<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test de Preferencias - MotoMatch</title>  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/counter-selector.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/test-fix.css') }}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Modificar el orden de carga de scripts -->  <script>
    // Función para cargar scripts secuencialmente con reintento
    function loadScriptsSequentially(scripts, callback, attempt = 1) {
      if (scripts.length === 0) {
        if (callback) callback();
        return;
      }
      
      var script = document.createElement('script');
      script.src = scripts[0] + "?v=" + Date.now(); // Evitar caché
      
      script.onload = function() {
        console.log('Script cargado exitosamente: ' + scripts[0]);
        // Cargar el siguiente script
        loadScriptsSequentially(scripts.slice(1), callback);
      };
      
      script.onerror = function() {
        console.error('Error al cargar: ' + scripts[0] + ', intento: ' + attempt);
        if (attempt < 3) {
          // Reintentar hasta 3 veces con delay incremental
          setTimeout(() => {
            loadScriptsSequentially(scripts, callback, attempt + 1);
          }, attempt * 1000);
        } else {
          // Después de 3 intentos fallidos, continuar con el siguiente script
          console.error('Error fatal al cargar ' + scripts[0] + ' después de 3 intentos');
          loadScriptsSequentially(scripts.slice(1), callback);
        }
      };
      
      document.head.appendChild(script);
    }
    
    // Al cargar el documento, cargamos todos los scripts en orden
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM cargado, cargando scripts...');      // Nuevo orden de scripts - Counter-selector primero
      var scripts = [
        "{{ url_for('static', filename='js/test_reorganizer.js') }}",
        "{{ url_for('static', filename='js/counter-selector.js') }}",
        "{{ url_for('static', filename='js/debug-panel.js') }}",
        "{{ url_for('static', filename='js/test.js') }}",
        "{{ url_for('static', filename='js/test_finalizacion_fixed.js') }}"
      ];
      
      // Cargar scripts en orden y luego inicializar con verificaciones adicionales
      loadScriptsSequentially(scripts, function() {
        console.log('Todos los scripts cargados, verificando CounterSelector...');
        
        // Verificar que CounterSelector está disponible
        if (typeof window.CounterSelector !== 'function') {
          console.error('CounterSelector no está disponible después de cargar scripts. Intentando recuperar...');
          // Cargar counter-selector.js directamente
          var scriptEmergencia = document.createElement('script');
          scriptEmergencia.src = "{{ url_for('static', filename='js/counter-selector.js') }}?emergency=" + Date.now();
          scriptEmergencia.onload = function() {
            console.log('Script de emergencia CounterSelector cargado. Reintentando inicialización...');
            if (typeof window.initializeTest === 'function') {
              setTimeout(window.initializeTest, 100);
            } else if (typeof window.recuperarTest === 'function') {
              setTimeout(window.recuperarTest, 100);
            }
          };
          document.head.appendChild(scriptEmergencia);
          return;
        }
        
        // Inicializar test si la función está disponible
        if (typeof window.initializeTest === 'function') {
          console.log('Función initializeTest encontrada, inicializando...');
          setTimeout(window.initializeTest, 100);
        } else {
          console.error('Error: La función initializeTest no está disponible');
          // Intentar método de recuperación
          if (typeof window.recuperarTest === 'function') {
            console.log('Intentando recuperación de test...');
            setTimeout(window.recuperarTest, 100);
          } else {
            console.error('No hay método de recuperación disponible');
            alert('Error al inicializar el test. Por favor, recarga la página.');
          }
        }
      });
    });
  </script>
  
  <!-- Script para manejar errores y mostrar botón de reintentar -->
  <script>
    // Función para mostrar el botón de reintentar después de un tiempo
    function mostrarBotonReintentar() {
      setTimeout(function() {
        // Verificar si los contadores se inicializaron correctamente
        var estilosCanvas = document.getElementById('estilos-canvas');
        var hayContadores = estilosCanvas && estilosCanvas.querySelector('.counter-selector-container');
        
        if (!hayContadores) {
          console.error("No se detectó inicialización correcta, mostrando botón de reintentar");
          var retryButton = document.getElementById('retry-button');
          if (retryButton) {
            retryButton.style.display = 'block';
          }
        }
      }, 3000); // Esperar 3 segundos antes de mostrar el botón
    }
    
    // Registrar función para ejecutar después de cargar scripts
    document.addEventListener('DOMContentLoaded', function() {
      mostrarBotonReintentar();
    });
    
    // Función de verificación durante navegación
    function verificarIntegridadContadores() {
      // Después de la navegación, verificar que los contadores estén intactos
      setTimeout(function() {
        const preguntaActiva = document.querySelector('.pregunta.active');
        if (preguntaActiva) {
          const id = preguntaActiva.id;
          console.log("Verificando integridad de los contadores en: " + id);
          
          if (id === 'pregunta-1') {
            const estilosCanvas = document.getElementById('estilos-canvas');
            const hayContadores = estilosCanvas && estilosCanvas.querySelector('.counter-selector-container');
            if (!hayContadores) {
              console.error("Contadores de estilos perdidos después de navegación");
              if (typeof window.verificarYRestaurarCanvas === 'function') {
                window.verificarYRestaurarCanvas('verificación automática');
              }
            }
          } else if (id === 'pregunta-2') {
            const marcasCanvas = document.getElementById('marcas-canvas');
            const hayContadores = marcasCanvas && marcasCanvas.querySelector('.counter-selector-container');
            if (!hayContadores) {
              console.error("Contadores de marcas perdidos después de navegación");
              if (typeof window.verificarYRestaurarCanvas === 'function') {
                window.verificarYRestaurarCanvas('verificación automática');
              }
            }
          }
        }
      }, 200);
    }
    
    // Observar cambios de pregunta activa
    document.addEventListener('DOMContentLoaded', function() {
      // Configurar observer para detectar cambios en clases
      const observer = new MutationObserver(function(mutations) {
        mutations.forEach(function(mutation) {
          if (mutation.type === 'attributes' && 
              mutation.attributeName === 'class' &&
              mutation.target.classList.contains('active')) {
            verificarIntegridadContadores();
          }
        });
      });
      
      // Observar todas las preguntas para detectar cuando se activan
      const preguntas = document.querySelectorAll('.pregunta');
      preguntas.forEach(function(pregunta) {
        observer.observe(pregunta, { attributes: true });
      });
      
      // Configurar listeners para botones de navegación
      const prevBtn = document.getElementById('prev-btn');
      const nextBtn = document.getElementById('next-btn');
      
      if (prevBtn) {
        prevBtn.addEventListener('click', verificarIntegridadContadores);
      }
      
      if (nextBtn) {
        nextBtn.addEventListener('click', verificarIntegridadContadores);
      }
    });
  </script>
  <style>
    /* Ajustes específicos para contenedores de selectores - versión elegante */
    .circle-canvas {
      min-height: 400px;
      height: 50vh;
      border-radius: 12px;
      margin-bottom: 15px;
      position: relative;
      overflow: hidden;
      width: 100%;
      background: linear-gradient(to bottom, rgba(30, 30, 32, 0.95), rgba(24, 24, 26, 0.95));
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.05);
      box-sizing: border-box;
    }
    
    /* Estilos para el botón de reintentar */
    .retry-button {
      display: none;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #f97316;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      font-size: 16px;
      z-index: 100;
    }
    
    .retry-button:hover {
      background-color: #ea580c;
    }
    
    .pregunta {
      display: none;
      background-color: rgba(0, 0, 0, 0.7);
      border-radius: 10px;
      padding: 25px;
      margin-bottom: 20px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      animation: fadeIn 0.5s ease;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .pregunta.active {
      display: block;
      opacity: 1;
    }
      /* Estilos mejorados para preguntas y transiciones */    .pregunta {
      margin-bottom: 20px;
      padding: 20px;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid #f97316;
      border-radius: 10px;
      transition: opacity 0.3s ease, transform 0.3s ease;
      opacity: 0;
      max-height: 0;
      overflow: hidden;
      transform: translateY(20px);
      pointer-events: none;
      position: absolute !important; /* Forzar posición absoluta */
      left: -9999px !important;
      display: none !important; /* Forzar ocultamiento */
      z-index: -1 !important; /* Asegurar que esté detrás */
      visibility: hidden !important; /* Triple seguridad */
    }
      .pregunta.active {
      opacity: 1 !important;
      max-height: none !important; /* No limitar altura */
      transform: translateY(0) !important;
      pointer-events: auto !important;
      position: relative !important;
      left: 0 !important;
      display: block !important; /* Forzar visualización */
      z-index: 10 !important; /* Traer al frente */
      visibility: visible !important; /* Triple seguridad */
    }
    
    /* Estilos para las transiciones entre preguntas */
    .pregunta:not(.active) {
      display: none !important; /* Forzar ocultamiento para todas las preguntas no activas */
    }
    
    .pregunta.active {
      opacity: 1;
      height: auto;
      overflow: visible;
      padding: 25px;
      margin: 20px 0;
      pointer-events: all;
    }
    
    /* Asegurar que el contenido dentro de las preguntas esté siempre centrado */
    .pregunta > * {
      max-width: 90%;
      margin-left: auto;
      margin-right: auto;
    }
    
    .progress-container {      
      width: 100%;
      height: 8px;
      background-color: rgba(255, 255, 255, 0.1);
      border-radius: 4px;
      margin-bottom: 20px;
      overflow: hidden;
    }
    
    .progress-bar {
      height: 100%;
      width: 0%;
      background-color: #f97316;
      transition: width 0.3s ease;
    }
    
    /* Animación para fadeIn */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .options-wrapper {
      width: 100%;
      height: 100%;
      padding: 0; /* Eliminamos el padding para que el contenedor ocupe todo el espacio */
    }
    
    /* Mejorar visibilidad de textos */
    h2 {
      color: #f97316;
      text-shadow: 0 0 2px rgba(0,0,0,0.5);
    }
    
    /* Estilo para ayudar a los usuarios a entender la interacción */
    .interaction-help {
      font-size: 14px;      
      font-style: italic;
      color: #f97316;
      margin-bottom: 10px;
    }

    /* Modal de finalización */
    .completion-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .modal-content {
      background-color: rgba(0, 0, 0, 0.9);
      border: 2px solid #f97316;
      border-radius: 10px;
      padding: 30px;
      max-width: 500px;
      text-align: center;
      box-shadow: 0 0 20px rgba(249, 115, 22, 0.5);
      animation: fadeIn 0.5s;
    }
    
    /* Estilos para los botones de navegación */
    .nav-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }
    
    .nav-button {
      background-color: #f97316;
      color: white;
      border: none;
      border-radius: 5px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .nav-button:hover {
      background-color: #ea580c;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }
    
    .nav-button:disabled {
      background-color: #666;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* Efecto de confeti para la finalización */
    @keyframes confettiDrop {
      0% { transform: translateY(-100px) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
    }
    
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      background-color: #f97316;
      border-radius: 50%;
      animation: confettiDrop 4s ease-in-out forwards;
      z-index: 1001;
    }
    
    /* Mejorar selectores */
    select {
      width: 100%;
      padding: 12px;
      border-radius: 5px;
      border: 1px solid #f97316;
      background-color: rgba(0, 0, 0, 0.7);
      color: white;
      margin-bottom: 15px;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    select:focus {
      outline: none;
      border-color: #ea580c;
      box-shadow: 0 0 8px rgba(249, 115, 22, 0.5);
    }
    
    option {
      background-color: #111;
      color: white;
    }
      .help-text {
      font-size: 14px;
      color: #aaa;
      font-style: italic;
      margin-top: 5px;
    }    /* Estilos para las ramas condicionales - forzar ocultamiento */
    .rama-tecnica, .rama-practica {
      display: none !important;
      height: 0 !important;
      overflow: hidden !important;
      opacity: 0 !important;
      pointer-events: none !important;
      position: absolute !important;
      visibility: hidden !important;
    }
    
    /* Solo mostrar cuando tienen clase active */
    .rama-tecnica.active, .rama-practica.active {
      display: block !important;
      height: auto !important;
      opacity: 1 !important;
      overflow: visible !important;
      pointer-events: auto !important;
      position: relative !important;
      visibility: visible !important;
    }
    
    /* Compatibilidad con lógica legacy de hidden-branch */
    .hidden-branch {
      display: none !important;
      height: 0 !important;
      overflow: hidden !important;
      visibility: hidden !important;
    }
      /* Estilos para el rango slider de presupuesto */
    .budget-range-container {
      margin: 20px auto;
      padding: 25px;
      max-width: 600px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      box-sizing: border-box;
    }
    
    .budget-labels {
      display: flex;
      justify-content: space-between;
      margin-bottom: 25px;
      font-size: 16px;
      color: #f97316;
      font-weight: 500;
    }    .range-slider-container {
      position: relative;
      height: 40px;
      margin: 30px 15px;
      padding: 0 10px;
      box-sizing: border-box;
    }
    
    /* CSS para sliders duales mejorados */
    .dual-range-container {
      background: rgba(255, 255, 255, 0.05);
      padding: 25px;
      border-radius: 12px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      margin: 20px 0;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }
    
    .range-display {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
      font-size: 16px;
    }
    
    .range-display span {
      color: #ddd;
      background: rgba(255, 255, 255, 0.05);
      padding: 8px 12px;
      border-radius: 8px;
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .range-display strong {
      color: #f97316;
      font-weight: 600;
    }
    
    .dual-slider-wrapper {
      position: relative;
      height: 50px;
      margin: 20px 0;
    }
    
    .dual-slider {
      position: absolute;
      width: 100%;
      height: 6px;
      background: transparent;
      outline: none;
      -webkit-appearance: none;
      appearance: none;
      pointer-events: none;
      top: 50%;
      transform: translateY(-50%);
    }
    
    .dual-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: #f97316;
      border: 2px solid white;
      border-radius: 50%;
      cursor: pointer;
      pointer-events: all;
      box-shadow: 0 3px 8px rgba(249, 115, 22, 0.4);
      transition: all 0.3s ease;
      position: relative;
      z-index: 10;
    }
    
    .dual-slider::-webkit-slider-thumb:hover {
      background: #ea580c;
      transform: scale(1.15);
      box-shadow: 0 5px 15px rgba(249, 115, 22, 0.6);
    }
    
    .dual-slider::-webkit-slider-thumb:active {
      transform: scale(1.25);
      box-shadow: 0 6px 20px rgba(249, 115, 22, 0.8);
    }
    
    .dual-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: #f97316;
      border: 2px solid white;
      border-radius: 50%;
      cursor: pointer;
      pointer-events: all;
      box-shadow: 0 3px 8px rgba(249, 115, 22, 0.4);
      transition: all 0.3s ease;
      -moz-appearance: none;
    }
    
    .dual-slider::-moz-range-thumb:hover {
      background: #ea580c;
      transform: scale(1.15);
      box-shadow: 0 5px 15px rgba(249, 115, 22, 0.6);
    }
    
    /* Diferenciación visual entre slider mínimo y máximo */
    .slider-min::-webkit-slider-thumb {
      border: 3px solid #f97316;
      background: white;
    }
    
    .slider-max::-webkit-slider-thumb {
      background: #f97316;
      border: 2px solid white;
    }
    
    .slider-min::-webkit-slider-thumb:hover {
      background: #f97316;
      border-color: white;
    }
    
    .slider-max::-webkit-slider-thumb:hover {
      background: #ea580c;
    }
    
    .slider-min::-moz-range-thumb {
      border: 3px solid #f97316;
      background: white;
    }
    
    .slider-max::-moz-range-thumb {
      background: #f97316;
      border: 2px solid white;
    }
    
    .dual-slider::-webkit-slider-track {
      background: transparent;
      height: 6px;
    }
    
    .dual-slider::-moz-range-track {
      background: transparent;
      height: 6px;
      border: none;
    }
    
    .slider-track {
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      transform: translateY(-50%);
      z-index: 1;
    }
    
    .slider-progress {
      position: absolute;
      height: 100%;
      background: linear-gradient(90deg, #f97316, #ea580c);
      border-radius: 3px;
      transition: all 0.3s ease;
      z-index: 2;
    }
    
    .range-labels {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      font-size: 12px;
      color: #aaa;
    }
    
    .range-labels span {
      padding: 4px 8px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 6px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
    }
    
    .range-labels span:hover {
      background: rgba(249, 115, 22, 0.1);
      border-color: rgba(249, 115, 22, 0.3);
      color: #f97316;
    }
    
    .range-description {
      font-size: 14px;
      color: #ddd;
      margin-top: 15px;
      text-align: center;
      font-style: italic;
    }
    
    /* SECCIÓN DE CILINDRADA CON RANGO DUAL */
    #cilindrada {
      margin: 40px 0;
    }
    
    .cilindrada-slider-container {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    /* SECCIÓN DE POTENCIA CON RANGO DUAL */
    #potencia {
      margin: 40px 0;
    }
    
    .potencia-slider-container {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    /* SECCIÓN DE TORQUE CON RANGO DUAL (OPCIONAL) */
    #torque {
      margin: 40px 0;
    }
    
    .torque-slider-container {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    /* SECCIÓN DE PESO CON RANGO DUAL (OPCIONAL) */
    #peso {
      margin: 40px 0;
    }
    
    .peso-slider-container {
      background: rgba(255, 255, 255, 0.05);
      padding: 20px;
      border-radius: 10px;
      border: 1px solid rgba(249, 115, 22, 0.3);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    
    /* Estilos para corregir visualización de preguntas */
  .pregunta {
    display: none;
    width: 100%;
    margin-bottom: 20px;
  }
  
  .pregunta.active {
    display: block !important;
  }
  
  /* Estilos para preguntas técnicas */
  .rama-tecnica {
    border-left: 3px solid #3498db;
    padding-left: 15px;
  }
  
  /* Estilos para preguntas prácticas */
  .rama-practica {
    border-left: 3px solid #e67e22;
    padding-left: 15px;
  }
  
  /* Estilos para preguntas ocultas por data-hidden */
  [data-hidden="true"] {
    display: none !important;
  }
  
  /* Mejorar la transición entre preguntas */
  .pregunta {
    transition: opacity 0.3s ease-in-out;
  }
  
  .pregunta.active {
    opacity: 1;
  }
  
  .pregunta:not(.active) {
    display: none !important;
    opacity: 0;
    position: absolute;
    pointer-events: none;
  }
  </style>
</head>
<body>
  <a href="{{ url_for('main.dashboard') }}" class="back-dashboard-btn">
    <i class="fas fa-arrow-left"></i> Regresar al Dashboard
  </a>
  
  <div id="contenedorPrincipalTest" class="main-container">
    <div class="test-container">
      <h1 class="tituloFriends">Test de Preferencias</h1>
      
      <div class="progress-container">
        <div class="progress-bar" id="progress-bar"></div>
      </div>
      
      <!-- Pregunta 1: Estilo de moto -->
      <section class="pregunta active" id="pregunta-1" data-type="selector" data-key="estilos">
        <h2>1. ¿Qué estilo(s) de moto te gustan más?</h2>
        <p>Utiliza los botones + y - para indicar tu nivel de preferencia (0-4)</p>
        <p class="interaction-help">El nivel 4 indica tu máxima preferencia</p>
        <div class="options-wrapper">
          <div class="circle-canvas" id="estilos-canvas">
            <!-- Botón de reintentar en caso de error -->
            <button id="retry-button" class="retry-button" onclick="window.verificarYRestaurarCanvas('botón reintentar')">Error al cargar. Reintentar</button>
          </div>
        </div>
      </section>

      <!-- Pregunta 2: Marca favorita -->
      <section class="pregunta" id="pregunta-2" data-type="selector" data-key="marcas">
        <h2>2. ¿Qué marca(s) prefieres?</h2>
        <p>Utiliza los botones + y - para indicar tu nivel de preferencia (0-4)</p>
        <p class="interaction-help">El nivel 4 indica tu máxima preferencia</p>
        <div class="options-wrapper">
          <div class="circle-canvas" id="marcas-canvas">
            <!-- Botón de reintentar en caso de error -->
            <button id="retry-button-marcas" class="retry-button" onclick="window.verificarYRestaurarCanvas('botón reintentar marcas')">Error al cargar. Reintentar</button>
          </div>
        </div>
      </section>      <!-- Pregunta 3: Condicional - Interés en especificaciones (PUNTO DE BIFURCACIÓN) -->
      <section class="pregunta" id="pregunta-3" data-type="select" data-key="interesa_especificaciones" data-branch="true">
        <h2>3. ¿Te interesan las especificaciones técnicas de la moto?</h2>
        <select name="interesa_especificaciones" id="interesa_especificaciones">
          <option value="si">Sí, me interesan los detalles técnicos (cilindrada, potencia, torque)</option>
          <option value="no">No, prefiero información general de uso (comodidad, economía, practicidad)</option>
        </select>
        <p class="help-text">Esta respuesta determinará el tipo de preguntas que se te mostrarán a continuación</p>
      </section>

      <!-- Pregunta 4: Rango de Presupuesto -->
      <section class="pregunta" id="pregunta-4" data-type="range" data-key="presupuesto">
        <h2>4. ¿Cuál es tu rango de presupuesto?</h2>
        <div class="dual-range-container">
            <div class="range-display">
                <span>Desde: <strong id="presupuesto-min-display">Q15,000</strong></span>
                <span>Hasta: <strong id="presupuesto-max-display">Q50,000</strong></span>
            </div>
            <div class="dual-slider-wrapper">
                <input type="range" id="presupuesto_min" min="5000" max="200000" step="1000" value="15000" class="dual-slider slider-min" data-capture="true">
                <input type="range" id="presupuesto_max" min="5000" max="200000" step="1000" value="50000" class="dual-slider slider-max" data-capture="true">
                <div class="slider-track">
                    <div id="presupuesto-progress" class="slider-progress"></div>
                </div>
            </div>
            <div class="range-labels">
                <span>Q25,000</span>
                <span>Q50,000</span>
                <span>Q100,000</span>
                <span>Q150,000</span>
                <span>Q200,000</span>
            </div>
            <p class="range-description">Ajusta tu rango de presupuesto ideal</p>
        </div></section>      <!-- Pregunta 5: Rango de años -->
      <section class="pregunta" id="pregunta-5" data-type="range" data-key="ano">
        <h2>5. ¿Qué rango de años prefieres?</h2>
        <div class="dual-range-container">
            <div class="range-display">
                <span>Desde: <strong id="ano-min-display">2015</strong></span>
                <span>Hasta: <strong id="ano-max-display">2025</strong></span>
            </div>
            <div class="dual-slider-wrapper">
                <input type="range" id="ano_min" min="2000" max="2025" step="1" value="2015" class="dual-slider slider-min" data-capture="true">
                <input type="range" id="ano_max" min="2000" max="2025" step="1" value="2025" class="dual-slider slider-max" data-capture="true">
                <div class="slider-track">
                    <div id="ano-progress" class="slider-progress"></div>
                </div>
            </div>
            <div class="range-labels">
                <span>2000</span>
                <span>2007</span>
                <span>2014</span>
                <span>2020</span>
                <span>2025</span>
            </div>
            <p class="range-description">Años más recientes = mejor tecnología, años más antiguos = mejor precio</p>
        </div>
      </section><!-- Pregunta 6: Peso preferido -->
      <section class="pregunta" id="pregunta-6" data-type="range" data-key="peso">
        <h2>6. ¿Qué rango de peso prefieres?</h2>
        <div class="dual-range-container">
            <div class="range-display">
                <span>Desde: <strong id="peso-min-display">120kg</strong></span>
                <span>Hasta: <strong id="peso-max-display">200kg</strong></span>
            </div>
            <div class="dual-slider-wrapper">
                <input type="range" id="peso_min" min="80" max="300" step="10" value="120" class="dual-slider slider-min" data-capture="true">
                <input type="range" id="peso_max" min="80" max="300" step="10" value="200" class="dual-slider slider-max" data-capture="true">
                <div class="slider-track">
                    <div id="peso-progress" class="slider-progress"></div>
                </div>
            </div>
            <div class="range-labels">
                <span>75kg</span>
                <span>150kg</span>
                <span>225kg</span>
                <span>300kg</span>
                
            </div>
            <p class="range-description">Menos peso = mejor maniobrabilidad, más peso = mayor estabilidad</p>
        </div>
      </section>
      
      <!-- Pregunta 7: Relación potencia/peso -->
      <section class="pregunta" id="pregunta-7" data-type="select" data-key="preferencia_potencia_peso">
        <h2>7. ¿Prefieres una moto con mejor relación potencia/peso?</h2>
        <select name="preferencia_potencia_peso" id="preferencia_potencia_peso">
          <option value="alta">Alta relación potencia/peso (más deportiva)</option>
          <option value="media">Relación media potencia/peso (equilibrada)</option>
          <option value="baja">Baja relación potencia/peso (más relajada)</option>
        </select>
        <p class="help-text">Una mejor relación potencia/peso significa más agilidad y aceleración</p>
      </section>
      
      <!-- Pregunta 8: Rendimiento vs Economía -->
      <section class="pregunta" id="pregunta-8" data-type="select" data-key="preferencia_rendimiento">
        <h2>8. ¿Te interesa más rendimiento o economía?</h2>
        <select name="preferencia_rendimiento" id="preferencia_rendimiento">
          <option value="rendimiento">Rendimiento (potencia, velocidad, aceleración)</option>
          <option value="economia">Economía (bajo consumo, mantenimiento económico)</option>
          <option value="balance">Balance entre rendimiento y economía</option>
        </select>
        <p class="help-text">Tu prioridad principal en el uso de la moto</p>
      </section>      <!-- RAMA TÉCNICA (SI en pregunta 3) -->      <!-- Pregunta 9a: Rango de potencia (Técnica) -->
      <section class="pregunta rama-tecnica" id="pregunta-9a" data-type="range" data-key="potencia" data-branch-target="si">
        <h2>9. ¿Cuánta potencia prefieres?</h2>
        <div class="dual-range-container">
            <div class="range-display">
                <span>Desde: <strong id="potencia-min-display">15CV</strong></span>
                <span>Hasta: <strong id="potencia-max-display">100CV</strong></span>
            </div>
            <div class="dual-slider-wrapper">
                <input type="range" id="potencia_min" min="5" max="300" step="5" value="15" class="dual-slider slider-min" data-capture="true">
                <input type="range" id="potencia_max" min="5" max="300" step="5" value="100" class="dual-slider slider-max" data-capture="true">
                <div class="slider-track">
                    <div id="potencia-progress" class="slider-progress"></div>
                </div>
            </div>
            <div class="range-labels">
                <span>5CV</span>
                <span>75CV</span>
                <span>150CV</span>
                <span>225CV</span>
                <span>300CV</span>
            </div>
            <p class="range-description">Más potencia = mayor velocidad pero requiere más experiencia</p>
        </div>
      </section>        <!-- Pregunta 10a: Desplazamiento (Técnica) -->
      <section class="pregunta rama-tecnica" id="pregunta-10a" data-type="range" data-key="cilindrada" data-branch-target="si">        <h2>10. ¿Qué cilindrada del motor prefieres?</h2>
        <div class="dual-range-container">
            <div class="range-display">
                <span>Desde: <strong id="cilindrada-min-display">125cc</strong></span>
                <span>Hasta: <strong id="cilindrada-max-display">600cc</strong></span>
            </div>
            <div class="dual-slider-wrapper">
                <input type="range" id="cilindrada_min" min="50" max="1500" step="25" value="125" class="dual-slider slider-min" data-capture="true">
                <input type="range" id="cilindrada_max" min="50" max="1500" step="25" value="600" class="dual-slider slider-max" data-capture="true">
                <div class="slider-track">
                    <div id="cilindrada-progress" class="slider-progress"></div>
                </div>
            </div>
            <div class="range-labels">
                <span>50cc</span>
                <span>400cc</span>
                <span>750cc</span>
                <span>1100cc</span>
                <span>1500cc</span>
            </div>
            <p class="range-description">Mayor cilindrada = más potencia pero más consumo</p>
        </div>
      </section>        <!-- Pregunta 11a: Torque (Técnica) -->
      <section class="pregunta rama-tecnica" id="pregunta-11a" data-type="range" data-key="torque" data-branch-target="si">
        <h2>11. ¿Qué torque prefieres?</h2>
        <div class="dual-range-container">
            <div class="range-display">
                <span>Desde: <strong id="torque-min-display">10Nm</strong></span>
                <span>Hasta: <strong id="torque-max-display">80Nm</strong></span>
            </div>
            <div class="dual-slider-wrapper">
                <input type="range" id="torque_min" min="5" max="200" step="5" value="10" class="dual-slider slider-min" data-capture="true">
                <input type="range" id="torque_max" min="5" max="200" step="5" value="80" class="dual-slider slider-max" data-capture="true">
                <div class="slider-track">
                    <div id="torque-progress" class="slider-progress"></div>
                </div>
            </div>
            <div class="range-labels">
                <span>5Nm</span>
                <span>50Nm</span>
                <span>100Nm</span>
                <span>150Nm</span>
                <span>200Nm</span>
            </div>
            <p class="range-description">Mayor torque = mejor aceleración y fuerza de arranque</p>
        </div>
      </section>
      
      <!-- RAMA PRÁCTICA (NO en pregunta 3) -->
      <!-- Pregunta 9b: Tipo de uso (Práctica) -->
      <section class="pregunta rama-practica" id="pregunta-9b" data-type="select" data-key="tipo_uso" data-branch-target="no">
        <h2>9. ¿Para qué la usarás principalmente?</h2>
        <select name="tipo_uso" id="tipo_uso">
          <option value="ciudad">Ciudad/Urbano</option>
          <option value="carretera">Carretera/Viajes largos</option>
          <option value="mixto">Mixto (ciudad y carretera)</option>
          <option value="aventura">Aventura/Terreno mixto</option>
        </select>
        <p class="help-text">El uso principal influye en el tipo de moto más conveniente</p>
      </section>
      
      <!-- Pregunta 10b: Pasajeros y carga (Práctica) -->
      <section class="pregunta rama-practica" id="pregunta-10b" data-type="select" data-key="pasajeros_carga" data-branch-target="no">
        <h2>10. ¿Llevarás pasajeros o carga frecuentemente?</h2>
        <select name="pasajeros_carga" id="pasajeros_carga">
          <option value="solo">Solo yo la mayoría del tiempo</option>
          <option value="ocasional">Ocasionalmente with pasajero</option>
          <option value="frecuente">Frecuentemente con pasajero</option>
          <option value="carga">Necesito cargar cosas seguido</option>
        </select>
        <p class="help-text">Esto afecta el tipo de asiento y capacidad de carga necesaria</p>
      </section>
      
      <!-- Pregunta 11b: Combustible vs Potencia (Práctica) -->
      <section class="pregunta rama-practica" id="pregunta-11b" data-type="select" data-key="combustible_potencia" data-branch-target="no">
        <h2>11. ¿Qué es más importante para ti?</h2>
        <select name="combustible_potencia" id="combustible_potencia">
          <option value="ahorro">Ahorro de combustible</option>
          <option value="potencia">Tener potencia suficiente</option>
          <option value="equilibrio">Un equilibrio entre ambos</option>
        </select>
        <p class="help-text">Tu prioridad entre eficiencia y rendimiento</p>
      </section>

      <div class="nav-buttons">
        <button id="prev-btn" class="nav-button" disabled><i class="fas fa-arrow-left"></i> Anterior</button>
        <button id="next-btn" class="nav-button">Siguiente <i class="fas fa-arrow-right"></i></button>
      </div>
    </div>
  </div>

  <!-- Modal de finalización -->
  <div class="completion-modal" id="completion-modal">
    <div class="modal-content">
      <h2>¡Test completado con éxito!</h2>
      <p>Gracias por completar el test de preferencias. Con esta información podremos recomendarte las mejores motos que se ajusten a tus gustos.</p>
      <button id="finish-btn" class="nav-button" onclick="finalizarTest()">Ver mis recomendaciones</button>
    </div>
  </div>
  <script>
  // Función para finalizar el test y enviar datos a recomendaciones
  function finalizarTest(testData) {
    // Crear un formulario oculto para enviar los datos
    const form = document.createElement('form');
    form.method = 'POST';
    form.action = "{{ url_for('main.guardar_test') }}";
    form.style.display = 'none';
    
    // Agregar los datos del test como campos ocultos
    for (const key in testData) {
      if (testData.hasOwnProperty(key)) {
        const input = document.createElement('input');
        input.type = 'hidden';
        input.name = key;
        input.value = typeof testData[key] === 'object' ? 
          JSON.stringify(testData[key]) : testData[key];
        form.appendChild(input);
      }
    }
    
    // Enviar el formulario
    document.body.appendChild(form);
    console.log("Enviando datos del test:", testData);
    form.submit();
  }  // Lógica de bifurcación para la pregunta 3
  document.addEventListener('DOMContentLoaded', function() {
    // Configurar listener específico para la pregunta de bifurcación
    const pregunta3Select = document.getElementById('interesa_especificaciones');
    
    /* START OF BLOCK TO COMMENT OUT 
    // This inline logic might conflict with test_branch_fixed.js
    // We will let test_branch_fixed.js handle the branching logic.
    if (pregunta3Select) {
      pregunta3Select.addEventListener('change', function() {
        const value = this.value;
        console.log('Bifurcación seleccionada (inline script - will be disabled):', value);
        
        window.testResults = window.testResults || {};
        window.testResults.interesa_especificaciones = value;
        window.respuestas = window.respuestas || {};
        window.respuestas.interesa_especificaciones = value;

        // The following lines that add/remove 'active' directly will be handled by test_branch_fixed.js
        // document.querySelectorAll('.rama-tecnica, .rama-practica').forEach(pregunta => {
        //   pregunta.classList.remove('active');
        // });
        // 
        // if (value === 'si') {
        //   document.querySelectorAll('.rama-practica').forEach(pregunta => {
        //     pregunta.classList.remove('active');
        //   });
        //   const primeraPreguntaTecnica = document.querySelector('#pregunta-9a');
        //   if (primeraPreguntaTecnica) {
        //     primeraPreguntaTecnica.classList.add('active');
        //   }
        // } else if (value === 'no') {
        //   document.querySelectorAll('.rama-tecnica').forEach(pregunta => {
        //     pregunta.classList.remove('active');
        //   });
        //   const primeraPreguntaPractica = document.querySelector('#pregunta-9b');
        //   if (primeraPreguntaPractica) {
        //     primeraPreguntaPractica.classList.add('active');
        //   }
        // }

        // Instead, ensure test_branch_fixed.js has a robust handler for this.
        // If test_branch_fixed.js has its own event listener for 'interesa_especificaciones',
        // this entire inline listener might be redundant. For now, we just disable its actions.
        // A function call like this would be ideal if test_branch_fixed.js exposes it:
        // if (window.handleBranchChange) {
        //     window.handleBranchChange(value);
        // }
      });
    }
    END OF BLOCK TO COMMENT OUT */
    
    // Modificar el comportamiento del botón de finalización en el modal
    const finishButton = document.querySelector('.completion-modal .modal-content button');
    
    if (finishButton) {
      finishButton.addEventListener('click', function() {
        // IMPORTANTE: Primero aseguramos que los datos de los selectores se transfieran a testResults
        if (!window.testResults) {
          window.testResults = {};
        }
        
        // Asegurar que las selecciones se transfieran a testResults
        window.testResults.estilos = window.respuestas ? window.respuestas.estilos : {};
        window.testResults.marcas = window.respuestas ? window.respuestas.marcas : {};
        
        // Recolectar datos de todas las preguntas respondidas
        const selects = document.querySelectorAll('.pregunta select');
        selects.forEach(select => {
          if (select.value) {
            const key = select.name || select.id;
            if (key) {
              window.testResults[key] = select.value;
            }
          }
        });
        
        // Recolectar datos de inputs (presupuesto)
        const inputs = document.querySelectorAll('.pregunta input[type="number"]');
        inputs.forEach(input => {
          if (input.value && input.name) {
            window.testResults[input.name] = input.value;
          }
        });
        
        // Recolectar todos los datos del test
        const testData = {
          // Datos básicos del test
          experiencia: window.testResults.experiencia || 'intermedio',
          presupuesto: window.testResults.presupuesto || window.testResults.presupuesto_min || '15000',
          presupuesto_min: window.testResults.presupuesto_min || '15000',
          presupuesto_max: window.testResults.presupuesto_max || '50000',
          
          // Nuevas respuestas del cuestionario
          preferencia_ano: window.testResults.preferencia_ano || 'recientes',
          preferencia_peso: window.testResults.preferencia_peso || 'media',
          preferencia_potencia_peso: window.testResults.preferencia_potencia_peso || 'media',
          preferencia_rendimiento: window.testResults.preferencia_rendimiento || 'balance',
          interesa_especificaciones: window.testResults.interesa_especificaciones || 'no',
            // Rama técnica
          rango_potencia: window.testResults.rango_potencia || '',
          cilindrada: window.testResults.cilindrada || '',
          torque: window.testResults.torque || '',
          
          // Rama práctica
          tipo_uso: window.testResults.tipo_uso || '',
          pasajeros_carga: window.testResults.pasajeros_carga || '',
          combustible_potencia: window.testResults.combustible_potencia || '',
          
          // Usar window.testResults para las selecciones 
          estilos: window.testResults.estilos || {},
          marcas: window.testResults.marcas || {}
        };
        
        // Log para depuración
        console.log("Datos completos del test:", testData);
        
        // Enviar los datos a la ruta de procesamiento
        finalizarTest(testData);
      });
    }  });
</script>

<!-- Agregar el script de ayuda para sliders -->
<script src="{{ url_for('static', filename='js/test_slider_helpers.js') }}"></script>

<script>
// JavaScript para sliders duales con dos controles (min/max)
document.addEventListener('DOMContentLoaded', function() {
  console.log("Inicializando sliders duales...");
  
  // Asegurar que los objetos globales existan
  if (!window.testResults) window.testResults = {};
  if (!window.respuestas) window.respuestas = {};

  // Verificar si SliderManager está disponible
  if (typeof window.SliderManager === 'undefined') {
    console.error("SliderManager no está disponible. Cargando funcionalidad básica...");
    
    // Implementación básica de respaldo
    function initBasicDualSlider(config) {
      const minSlider = document.getElementById(config.minId);
      const maxSlider = document.getElementById(config.maxId);
      const minDisplay = document.getElementById(config.minDisplayId);
      const maxDisplay = document.getElementById(config.maxDisplayId);
      const progress = document.getElementById(config.progressId);
      
      if (!minSlider || !maxSlider) {
        console.warn(`Sliders no encontrados: ${config.minId}, ${config.maxId}`);
        return;
      }
      
      function updateDisplay() {
        let minVal = parseInt(minSlider.value);
        let maxVal = parseInt(maxSlider.value);
        
        // Asegurar que min <= max
        if (minVal > maxVal) {
          if (minSlider === document.activeElement) {
            maxVal = minVal;
            maxSlider.value = maxVal;
          } else {
            minVal = maxVal;
            minSlider.value = minVal;
          }
        }
        
        // Actualizar displays
        if (minDisplay) minDisplay.textContent = config.format(minVal);
        if (maxDisplay) maxDisplay.textContent = config.format(maxVal);
        
        // Actualizar progreso visual
        if (progress) {
          const minPercent = ((minVal - parseInt(minSlider.min)) / (parseInt(minSlider.max) - parseInt(minSlider.min))) * 100;
          const maxPercent = ((maxVal - parseInt(minSlider.min)) / (parseInt(maxSlider.max) - parseInt(minSlider.min))) * 100;
          progress.style.left = `${minPercent}%`;
          progress.style.width = `${maxPercent - minPercent}%`;
        }
        
        // Guardar valores en objetos globales
        window.testResults[`${config.key}_min`] = minVal;
        window.testResults[`${config.key}_max`] = maxVal;
        window.respuestas[`${config.key}_min`] = minVal;
        window.respuestas[`${config.key}_max`] = maxVal;
        
        console.log(`${config.key} actualizado: ${minVal} - ${maxVal}`);
      }
      
      // Eventos
      minSlider.addEventListener('input', updateDisplay);
      maxSlider.addEventListener('input', updateDisplay);
      minSlider.addEventListener('change', updateDisplay);
      maxSlider.addEventListener('change', updateDisplay);
      
      // Inicializar
      updateDisplay();
      
      return { updateDisplay };
    }
      // Configuraciones para cada slider dual
    const sliderConfigs = [
      {
        key: 'presupuesto',
        minId: 'presupuesto_min',
        maxId: 'presupuesto_max',
        minDisplayId: 'presupuesto-min-display',
        maxDisplayId: 'presupuesto-max-display',
        progressId: 'presupuesto-progress',
        format: (val) => `Q${val.toLocaleString()}`
      },
      {
        key: 'ano',
        minId: 'ano_min',
        maxId: 'ano_max',
        minDisplayId: 'ano-min-display',
        maxDisplayId: 'ano-max-display',
        progressId: 'ano-progress',
        format: (val) => `${val}`
      },
      {
        key: 'peso',
        minId: 'peso_min',
        maxId: 'peso_max',
        minDisplayId: 'peso-min-display',
        maxDisplayId: 'peso-max-display',
        progressId: 'peso-progress',
        format: (val) => `${val}kg`
      },
      {
        key: 'potencia',
        minId: 'potencia_min',
        maxId: 'potencia_max',
        minDisplayId: 'potencia-min-display',
        maxDisplayId: 'potencia-max-display',
        progressId: 'potencia-progress',
        format: (val) => `${val}CV`
      },
      {
        key: 'cilindrada',
        minId: 'cilindrada_min',
        maxId: 'cilindrada_max',
        minDisplayId: 'cilindrada-min-display',
        maxDisplayId: 'cilindrada-max-display',
        progressId: 'cilindrada-progress',
        format: (val) => `${val}cc`
      },
      {
        key: 'torque',
        minId: 'torque_min',
        maxId: 'torque_max',
        minDisplayId: 'torque-min-display',
        maxDisplayId: 'torque-max-display',
        progressId: 'torque-progress',
        format: (val) => `${val}Nm`
      }
    ];
    
    // Inicializar todos los sliders
    sliderConfigs.forEach(config => {
      try {
        initBasicDualSlider(config);
        console.log(`Slider dual ${config.key} inicializado correctamente`);
      } catch (error) {
        console.error(`Error inicializando slider ${config.key}:`, error);
      }
    });
    
  } else {
    // Usar SliderManager si está disponible
    console.log("Usando SliderManager avanzado...");
      // Configurar sliders usando SliderManager
    const sliderConfigs = [
      {
        storageKey: 'presupuesto',
        minSliderId: 'presupuesto_min',
        maxSliderId: 'presupuesto_max',
        minDisplayId: 'presupuesto-min-display',
        maxDisplayId: 'presupuesto-max-display',
        progressId: 'presupuesto-progress',
        formatFn: (val) => `Q${val.toLocaleString()}`,
        defaults: { min: 15000, max: 50000 },
        storage: { testResults: window.testResults, respuestas: window.respuestas }
      },
      {
        storageKey: 'ano',
        minSliderId: 'ano_min',
        maxSliderId: 'ano_max',
        minDisplayId: 'ano-min-display',
        maxDisplayId: 'ano-max-display',
        progressId: 'ano-progress',
        formatFn: (val) => `${val}`,
        defaults: { min: 2015, max: 2025 },
        storage: { testResults: window.testResults, respuestas: window.respuestas }
      },
      {
        storageKey: 'peso',
        minSliderId: 'peso_min',
        maxSliderId: 'peso_max',
        minDisplayId: 'peso-min-display',
        maxDisplayId: 'peso-max-display',
        progressId: 'peso-progress',
        formatFn: (val) => `${val}kg`,
        defaults: { min: 120, max: 200 },
        storage: { testResults: window.testResults, respuestas: window.respuestas }
      },
      {
        storageKey: 'potencia',
        minSliderId: 'potencia_min',
        maxSliderId: 'potencia_max',
        minDisplayId: 'potencia-min-display',
        maxDisplayId: 'potencia-max-display',
        progressId: 'potencia-progress',
        formatFn: (val) => `${val}CV`,
        defaults: { min: 15, max: 100 },
        storage: { testResults: window.testResults, respuestas: window.respuestas }
      },
      {
        storageKey: 'cilindrada',
        minSliderId: 'cilindrada_min',
        maxSliderId: 'cilindrada_max',
        minDisplayId: 'cilindrada-min-display',
        maxDisplayId: 'cilindrada-max-display',
        progressId: 'cilindrada-progress',
        formatFn: (val) => `${val}cc`,
        defaults: { min: 125, max: 600 },
        storage: { testResults: window.testResults, respuestas: window.respuestas }
      },
      {
        storageKey: 'torque',
        minSliderId: 'torque_min',
        maxSliderId: 'torque_max',
        minDisplayId: 'torque-min-display',
        maxDisplayId: 'torque-max-display',
        progressId: 'torque-progress',
        formatFn: (val) => `${val}Nm`,
        defaults: { min: 10, max: 80 },
        storage: { testResults: window.testResults, respuestas: window.respuestas }
      }
    ];
    
    // Inicializar cada slider usando SliderManager
    sliderConfigs.forEach(config => {
      try {
        window.SliderManager.initRangeSlider(config);
        console.log(`Slider dual ${config.storageKey} inicializado con SliderManager`);
      } catch (error) {
        console.error(`Error inicializando slider ${config.storageKey}:`, error);
      }
    });
  }
  
  console.log("Todos los sliders duales inicializados");
  
  // Función para verificar captura de datos
  window.verificarCapturaSliders = function() {
    console.log("=== ESTADO ACTUAL DE SLIDERS ===");
    console.log("testResults:", window.testResults);
    console.log("respuestas:", window.respuestas);
      // Verificar elementos DOM específicos
    const sliderIds = [
      'presupuesto_min', 'presupuesto_max',
      'ano_min', 'ano_max',
      'peso_min', 'peso_max', 
      'potencia_min', 'potencia_max',
      'cilindrada_min', 'cilindrada_max',
      'torque_min', 'torque_max'
    ];
    
    sliderIds.forEach(id => {
      const element = document.getElementById(id);
      if (element) {
        console.log(`${id}: ${element.value}`);
      } else {
        console.warn(`Elemento ${id} no encontrado`);
      }
    });
  };
  
  // Hacer función disponible globalmente para debug
  window.verificarCapturaSliders();
});
</script>

<script src="{{ url_for('static', filename='js/test_branch_fixed.js') }}?v=fixedversion"></script>

  <footer>
    <p>&copy; 2025 MotoMatch. Todos los derechos reservados. | <a href="/" class="link">Inicio</a></p>
  </footer>
</body>
</html>